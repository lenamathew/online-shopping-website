<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmation - ShopEase</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Material Design Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Bootstrap Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="home.html">
                <span class="material-icons align-middle">shopping_bag</span>
                ShopEase
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="shop.html">
                    <span class="material-icons align-middle">store</span> Continue Shopping
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Success Section -->
    <section class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <!-- Success Message -->
                    <div class="text-center mb-5">
                        <div class="mb-4">
                            <span class="material-icons text-success" style="font-size: 4rem;">check_circle</span>
                        </div>
                        <h1 class="text-success mb-3">Order Confirmed!</h1>
                        <p class="lead">Thank you for your order. We've received your payment and your order is being processed.</p>
                        <div class="alert alert-success">
                            <strong>Order Number:</strong> <span id="orderNumber"></span>
                        </div>
                    </div>
                    
                    <!-- Order Details -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">
                                <span class="material-icons align-middle">receipt_long</span>
                                Order Details
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Customer Information</h6>
                                    <div id="customerInfo">
                                        <!-- Customer info will be loaded here -->
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6>Shipping Address</h6>
                                    <div id="shippingInfo">
                                        <!-- Shipping info will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <span class="material-icons align-middle">shopping_cart</span>
                                Order Items
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="orderItems">
                                <!-- Order items will be loaded here -->
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-md-8"></div>
                                <div class="col-md-4">
                                    <div class="d-flex justify-content-between">
                                        <span>Subtotal:</span>
                                        <span id="subtotal"></span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Shipping:</span>
                                        <span id="shipping"></span>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Tax:</span>
                                        <span id="tax"></span>
                                    </div>
                                    <hr>
                                    <div class="d-flex justify-content-between">
                                        <strong>Total:</strong>
                                        <strong id="total" class="text-primary"></strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Next Steps -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <span class="material-icons align-middle">info</span>
                                What's Next?
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 text-center mb-3">
                                    <span class="material-icons text-primary" style="font-size: 2rem;">email</span>
                                    <h6 class="mt-2">Order Confirmation</h6>
                                    <small class="text-muted">You'll receive an email confirmation within 5 minutes</small>
                                </div>
                                <div class="col-md-4 text-center mb-3">
                                    <span class="material-icons text-primary" style="font-size: 2rem;">inventory</span>
                                    <h6 class="mt-2">Order Processing</h6>
                                    <small class="text-muted">Your order will be processed within 1-2 business days</small>
                                </div>
                                <div class="col-md-4 text-center mb-3">
                                    <span class="material-icons text-primary" style="font-size: 2rem;">local_shipping</span>
                                    <h6 class="mt-2">Shipping</h6>
                                    <small class="text-muted">Estimated delivery: <span id="estimatedDelivery"></span></small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="text-center">
                        <a href="shop.html" class="btn btn-primary btn-lg me-3">
                            <span class="material-icons align-middle">store</span>
                            Continue Shopping
                        </a>
                        <button onclick="printOrder()" class="btn btn-outline-primary btn-lg">
                            <span class="material-icons align-middle">print</span>
                            Print Order
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container text-center">
            <p class="mb-0">&copy; 2025 ShopEase. All Rights Reserved.</p>
            <p class="mb-0">
                <small>
                    Questions? Contact us at 
                    <a href="mailto:support@shopease.com" class="text-white">support@shopease.com</a>
                    or call (555) 123-4567
                </small>
            </p>
        </div>
    </footer>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Load order confirmation when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadOrderConfirmation();
        });
        
        function loadOrderConfirmation() {
            try {
                // Get last order from localStorage
                const orderData = localStorage.getItem('lastOrder');
                if (!orderData) {
                    // No order data, redirect to shop
                    alert('No order found. Redirecting to shop.');
                    window.location.href = 'shop.html';
                    return;
                }
                
                const order = JSON.parse(orderData);
                console.log('Loading order:', order);
                
                // Display order number
                document.getElementById('orderNumber').textContent = order.orderNumber;
                
                // Display customer information
                document.getElementById('customerInfo').innerHTML = `
                    <p class="mb-1"><strong>${order.customer.firstName} ${order.customer.lastName}</strong></p>
                    <p class="mb-1">${order.customer.email}</p>
                    ${order.customer.phone ? `<p class="mb-0">${order.customer.phone}</p>` : ''}
                `;
                
                // Display shipping information
                document.getElementById('shippingInfo').innerHTML = `
                    <p class="mb-1">${order.shipping.address}</p>
                    <p class="mb-0">${order.shipping.city}, ${order.shipping.state} ${order.shipping.zipCode}</p>
                `;
                
                // Display order items
                const orderItemsContainer = document.getElementById('orderItems');
                orderItemsContainer.innerHTML = '';
                
                order.orderData.items.forEach(item => {
                    orderItemsContainer.innerHTML += `
                        <div class="row align-items-center mb-3 pb-3 border-bottom">
                            <div class="col-2">
                                <img src="${item.product.image}" alt="${item.product.name}" 
                                     class="img-fluid rounded" style="max-height: 60px; object-fit: cover;">
                            </div>
                            <div class="col-6">
                                <h6 class="mb-1">${item.product.name}</h6>
                                <small class="text-muted">${item.product.description}</small>
                            </div>
                            <div class="col-2 text-center">
                                <span>Qty: ${item.quantity}</span>
                            </div>
                            <div class="col-2 text-end">
                                <strong>$${item.total.toFixed(2)}</strong>
                            </div>
                        </div>
                    `;
                });
                
                // Display totals
                document.getElementById('subtotal').textContent = `$${order.orderData.subtotal.toFixed(2)}`;
                document.getElementById('shipping').textContent = order.orderData.shipping > 0 ? `$${order.orderData.shipping.toFixed(2)}` : 'FREE';
                document.getElementById('tax').textContent = `$${order.orderData.tax.toFixed(2)}`;
                document.getElementById('total').textContent = `$${order.orderData.total.toFixed(2)}`;
                
                // Calculate estimated delivery (5-7 business days from now)
                const deliveryDate = new Date();
                deliveryDate.setDate(deliveryDate.getDate() + 7);
                document.getElementById('estimatedDelivery').textContent = deliveryDate.toLocaleDateString();
                
                // Clean up - remove the temporary order data
                localStorage.removeItem('lastOrder');
                
            } catch (error) {
                console.error('Error loading order confirmation:', error);
                alert('Error loading order confirmation. Please contact support.');
                window.location.href = 'shop.html';
            }
        }
        
        function printOrder() {
            window.print();
        }
        
        // Confetti effect (optional fun touch!)
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.cssText = `
                    position: fixed;
                    top: -10px;
                    left: ${Math.random() * 100}%;
                    width: 10px;
                    height: 10px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    z-index: 9999;
                    animation: fall 3s linear forwards;
                    border-radius: 50%;
                `;
                
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }
        
        // Add confetti animation CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                from {
                    transform: translateY(-100vh) rotate(0deg);
                }
                to {
                    transform: translateY(100vh) rotate(360deg);
                }
            }
        `;
        document.head.appendChild(style);
        
        // Trigger confetti on page load
        setTimeout(createConfetti, 500);
        
        console.log('Order confirmation page loaded successfully');
    </script>
</body>
</html>